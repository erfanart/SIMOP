(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{2705:(e,t,r)=>{Promise.resolve().then(r.bind(r,8369))},8369:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>c});var n=r(5155),a=r(2115);function s(){let[e,t]=(0,a.useState)(""),[r,s]=(0,a.useState)(!1),c=(0,a.useRef)(null),l=(0,a.useRef)(null),o=(0,a.useRef)(null),i=(0,a.useRef)(null),u=async()=>{if(!navigator.mediaDevices)return void alert("Browser does not support media devices.");let e=await navigator.mediaDevices.getUserMedia({audio:!0});i.current=e;let r=new AudioContext({sampleRate:16e3});o.current=r;let n=r.createMediaStreamSource(e),a=r.createScriptProcessor(4096,1,1),u=new WebSocket("ws://localhost:2700/ws");u.binaryType="arraybuffer",u.onmessage=e=>{let r=JSON.parse(e.data);r.text&&t(r.text)},c.current=u,a.onaudioprocess=e=>{let t=e.inputBuffer.getChannelData(0),r=new Int16Array(t.length);for(let e=0;e<t.length;e++){let n=Math.max(-1,Math.min(1,t[e]));r[e]=n<0?32768*n:32767*n}u.readyState===WebSocket.OPEN&&u.send(r.buffer)},n.connect(a),a.connect(r.destination),l.current=a,s(!0)};return(0,n.jsxs)("div",{className:"p-4 space-y-4 border rounded bg-white shadow-md",children:[(0,n.jsx)("h2",{className:"text-xl font-bold",children:"\uD83C\uDFA4 Voice Recorder"}),(0,n.jsx)("button",{onClick:r?()=>{var e,t,r,n;null==(e=l.current)||e.disconnect(),null==(t=i.current)||t.getTracks().forEach(e=>e.stop()),null==(r=o.current)||r.close(),null==(n=c.current)||n.close(),s(!1)}:u,className:"px-4 py-2 rounded font-semibold ".concat(r?"bg-red-600 text-white":"bg-green-600 text-white"),children:r?"⏹ Stop Recording":"\uD83C\uDF99 Start Recording"}),(0,n.jsx)("div",{className:"border p-4 bg-gray-100 text-gray-800 rounded whitespace-pre-wrap min-h-[4rem]",children:e||"⏳ منتظر گفتار..."})]})}function c(){return(0,n.jsxs)("main",{className:"p-4",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"\uD83E\uDDE0 Voice Assistant"}),(0,n.jsx)(s,{})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[441,684,358],()=>t(2705)),_N_E=e.O()}]);